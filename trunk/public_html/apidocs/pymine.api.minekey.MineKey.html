<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>API docs for &ldquo;pymine.api.minekey.MineKey&rdquo;</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <link href="apidocs.css" type="text/css" rel="stylesheet" />
    
    
  </head>
  <body>
    <h1 class="class">Class p.a.m.MineKey:</h1>
    <p>
      <span id="part">Part of <a href="pymine.html">pymine</a>.<a href="pymine.api.html">api</a>.<a href="pymine.api.minekey.html">minekey</a></span>
      
      <a href="classIndex.html#pymine.api.minekey.MineKey">View In Hierarchy</a>
    </p>
    <div>
      
    </div>
    <div class="undocumented">No class docstring</div>
    
    
    <div id="splitTables">
      <table class="children sortable" id="id7">
  
  
  
  
  <tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#__init__">__init__</a></td>
    <td><span>Create a nu-format minekey.</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#__str__">__str__</a></td>
    <td><span>returns the minekey information WITHOUT hmac, in the following 
format:</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#validate">validate</a></td>
    <td><span>does a variety of sanity checks on self and throws a RuntimeError if 
surprised</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#get_feed">get_feed</a></td>
    <td><span>return a (cached) copy of the feed object corresponding to this 
minekey</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#get_item">get_item</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#key">key</a></td>
    <td><span>validates, and then returns the minekey information WITH hmac, in the 
following format:</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#permalink">permalink</a></td>
    <td><span>takes the result of self.key() and embeds / returns it in a</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#http_path">http_path</a></td>
    <td><span>returns the http://host.domain:port/ for this mine, for template use</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#clone">clone</a></td>
    <td><span>clone this minekey for further futzing</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#spawn_iid">spawn_iid</a></td>
    <td><span>from this minekey, spawn a new minekey object for the same</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#spawn_icon">spawn_icon</a></td>
    <td><span>from this minekey, spawn a new minekey object for the same</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#spawn_icon_self">spawn_icon_self</a></td>
    <td><span>return spawn_icon for self</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#spawn_submit_self">spawn_submit_self</a></td>
    <td><span>from this minekey, spawn a new minekey object for comment</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="pymine.api.minekey.MineKey.html#rewrite_html">rewrite_html</a></td>
    <td><span>using the context of this minekey, rewrite the blob of HTML</span></td>
  </tr>
  
</table>
      
      
    </div>
    
    
    
    <div class="function">
        <a name="pymine.api.minekey.MineKey.__init__"></a>
        <a name="__init__"></a>
        <div class="functionHeader">
        
        def __init__(self, **kwargs):
        
      </div>
        <div class="functionBody">
          
          <div>Create a nu-format minekey.</p>
<p>kwargs include: type: one of ('data', 'icon', 'submit') fid: integer 
feed id &gt; 0 fversion: integer feed version number &gt; 0 iid: integer 
item id &gt;= 0 depth: integer depth &gt; 0 ext: regexp ^\w+$ hmac: hmac 
against which to check this minekey request: request object for 
URL-generation purposes<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="pymine.api.minekey.MineKey.__str__"></a>
        <a name="__str__"></a>
        <div class="functionHeader">
        
        def __str__(self):
        
      </div>
        <div class="functionBody">
          
          <div>returns the minekey information WITHOUT hmac, in the following 
format:</p>
<p>fid/fversion/iid/depth/type<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="pymine.api.minekey.MineKey.validate"></a>
        <a name="validate"></a>
        <div class="functionHeader">
        
        def validate(self):
        
      </div>
        <div class="functionBody">
          
          <div>does a variety of sanity checks on self and throws a RuntimeError if 
surprised</p>
<p>returns the stripped hmac string</p>
<p>for a minekey such as &quot;HASH/42/1/11/2/data.dat&quot; - the 
validation covers everything from &quot;HASH&quot; to &quot;data&quot; 
inclusive; the trailing &quot;.dat&quot; is considered advisory.<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="pymine.api.minekey.MineKey.get_feed"></a>
        <a name="get_feed"></a>
        <div class="functionHeader">
        
        def get_feed(self):
        
      </div>
        <div class="functionBody">
          
          <div>return a (cached) copy of the feed object corresponding to this 
minekey<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="pymine.api.minekey.MineKey.get_item"></a>
        <a name="get_item"></a>
        <div class="functionHeader">
        
        def get_item(self):
        
      </div>
        <div class="functionBody">
          
          <div class="undocumented">Undocumented</div>
        </div>
      </div><div class="function">
        <a name="pymine.api.minekey.MineKey.key"></a>
        <a name="key"></a>
        <div class="functionHeader">
        
        def key(self):
        
      </div>
        <div class="functionBody">
          
          <div>validates, and then returns the minekey information WITH hmac, in the 
following format:</p>
<p>hmac/fid/fversion/iid/depth/type.ext</p>
<p>...the central portion being generated by __str__()<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="pymine.api.minekey.MineKey.permalink"></a>
        <a name="permalink"></a>
        <div class="functionHeader">
        
        def permalink(self):
        
      </div>
        <div class="functionBody">
          
          <div>takes the result of self.key() and embeds / returns it in a permalink 
string for this mine; for full pathname resolution it needs 'request' to be
set in the minekey constructor, or in a parent thereof<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="pymine.api.minekey.MineKey.http_path"></a>
        <a name="http_path"></a>
        <div class="functionHeader">
        
        def http_path(self):
        
      </div>
        <div class="functionBody">
          
          <div>returns the http://host.domain:port/ for this mine, for template use<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="pymine.api.minekey.MineKey.clone"></a>
        <a name="clone"></a>
        <div class="functionHeader">
        
        def clone(self):
        
      </div>
        <div class="functionBody">
          
          <div>clone this minekey for further futzing</p>
<p>if you do futz manually, remember to do minekey.validate()<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="pymine.api.minekey.MineKey.spawn_iid"></a>
        <a name="spawn_iid"></a>
        <div class="functionHeader">
        
        def spawn_iid(self, iid):
        
      </div>
        <div class="functionBody">
          
          <div>from this minekey, spawn a new minekey object for the same fid/fversion,
but for a different iid, decrementing depth<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="pymine.api.minekey.MineKey.spawn_icon"></a>
        <a name="spawn_icon"></a>
        <div class="functionHeader">
        
        def spawn_icon(self, iid):
        
      </div>
        <div class="functionBody">
          
          <div>from this minekey, spawn a new minekey object for the same fid/fversion,
but for a different iid's icon, decrementing depth<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="pymine.api.minekey.MineKey.spawn_icon_self"></a>
        <a name="spawn_icon_self"></a>
        <div class="functionHeader">
        
        def spawn_icon_self(self):
        
      </div>
        <div class="functionBody">
          
          <div>return spawn_icon for self<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="pymine.api.minekey.MineKey.spawn_submit_self"></a>
        <a name="spawn_submit_self"></a>
        <div class="functionHeader">
        
        def spawn_submit_self(self):
        
      </div>
        <div class="functionBody">
          
          <div>from this minekey, spawn a new minekey object for comment submission, 
setting depth=1 if depth is currently legal<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="pymine.api.minekey.MineKey.rewrite_html"></a>
        <a name="rewrite_html"></a>
        <div class="functionHeader">
        
        def rewrite_html(self, html):
        
      </div>
        <div class="functionBody">
          
          <div>using the context of this minekey, rewrite the blob of HTML (argument) 
looking for strings of the form:</p>
<p>HREF=/api/data/99 HREF=/api/data/99/dummy.html 
HREF='/api/data/99/dummy.html' HREF=&quot;/api/data/99&quot; 
SRC=/api/icon/99/dummy.png SRC='/api/icon/99' 
SRC=&quot;/api/icon/99/dummy.png&quot;</p>
<p>...where 99 is an example iid; the rewriter replacing the 99 with the 
results of self.spawn_iid(iid).permalink() - in other words a URL 
customised to retreive that item/iid with decremented depth.</p>
<p>The rewriter tries to be semi-clever, but not very, alas; it does not 
check that we are currently inside a &lt;TAG&gt; before rewriting such 
strings.  When BeautifulSoup comes in, that will change.</p>
<p>if the /api/icon/99/dummy.png URL is prefixed with either a single or 
double-quote, the rewriter checks that the substring to be rewritten ends 
with a corresponding quote; this is inadequate but should hope with 
unbalanced quotation marks during development.</p>
<p>if the URL does NOT begine with a quote characer, the rewriter ignores 
what the last character of the matched string, irrespective of whether it 
is a quote character or not.</p>
<p>if any sanity-check fails, the rewriter simply does not rewrite the 
HTML.<table class="fieldTable"></table></div>
        </div>
      </div>
    
    <address>
      <a href="index.html">API Documentation</a> for pymine, generated by <a href="http://codespeak.net/~mwh/pydoctor/">pydoctor</a> at 2010-02-14 07:37:49.
    </address>
  </body>
</html>